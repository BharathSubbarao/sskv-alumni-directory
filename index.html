<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SSKV Alumni Directory</title>
        <meta name="description" content="Connect with SSKV alumni worldwide - your premier alumni network">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
        <style>
            :root {
                --saffron: #FF9933;
                --deep-saffron: #FF8C00;
                --gold: #FFD700;
                --deep-red: #CC2936;
                --maroon: #8B0000;
                --cream: #FFF8DC;
                --warm-white: #FFFEF7;
                --gradient-primary: linear-gradient(135deg, #FF9933 0%, #FF8C00 100%);
                --gradient-secondary: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
                --gradient-card: linear-gradient(145deg, #FFFFFF 0%, #FFF8DC 100%);
                --shadow-soft: 0 4px 20px rgba(255, 153, 51, 0.15);
                --shadow-hover: 0 8px 30px rgba(255, 153, 51, 0.25);
                --shadow-deep: 0 10px 40px rgba(139, 0, 0, 0.2);
            }
    
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
    
            body {
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
                background: linear-gradient(135deg, #FFF8DC 0%, #FFFEF7 50%, #FFF8DC 100%);
                color: #2C2C2C;
                line-height: 1.6;
                overflow-x: hidden;
            }
    
            /* Header */
            .header {
                background: var(--gradient-primary);
                color: white;
                padding: 1.5rem 0;
                position: sticky;
                top: 0;
                z-index: 100;
                box-shadow: var(--shadow-deep);
            }
    
            .header-content {
                max-width: 1400px;
                margin: 0 auto;
                padding: 0 1.5rem;
                display: flex;
                align-items: center;
                justify-content: space-between;
                flex-wrap: wrap;
                gap: 1rem;
            }
    
            .logo-section {
                display: flex;
                align-items: center;
                gap: 1rem;
            }
    
            .logo {
                width: 70px;
                height: 50px;
                background: white;
                border-radius: 12px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 24px;
                color: var(--saffron);
                font-weight: 700;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }
    
            .header-title {
                font-family: 'Poppins', sans-serif;
                font-size: 2rem;
                font-weight: 700;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            }
    
            .header-subtitle {
                font-size: 0.9rem;
                opacity: 0.9;
                margin-top: 0.2rem;
            }
    
            .stats {
                display: flex;
                gap: 2rem;
                align-items: center;
            }
    
            .stat-item {
                text-align: center;
                background: rgba(255,255,255,0.15);
                padding: 0.5rem 1rem;
                border-radius: 10px;
                backdrop-filter: blur(10px);
            }
    
            .stat-number {
                font-size: 1.5rem;
                font-weight: 700;
                display: block;
            }
    
            .stat-label {
                font-size: 0.8rem;
                opacity: 0.9;
            }
    
            /* Search and Filters */
            .controls {
                max-width: 1400px;
                margin: 2rem auto;
                padding: 0 1.5rem;
            }
    
            .search-section {
                background: var(--gradient-card);
                border-radius: 20px;
                padding: 2rem;
                box-shadow: var(--shadow-soft);
                margin-bottom: 2rem;
            }
    
            .search-box {
                position: relative;
                margin-bottom: 1.5rem;
            }
    
            .search-input {
                width: 100%;
                padding: 1rem 1rem 1rem 3rem;
                border: 2px solid #E5E5E5;
                border-radius: 15px;
                font-size: 1.1rem;
                background: white;
                transition: all 0.3s ease;
                box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            }
    
            .search-input:focus {
                outline: none;
                border-color: var(--saffron);
                box-shadow: 0 0 0 4px rgba(255, 153, 51, 0.1);
            }
    
            .search-icon {
                position: absolute;
                left: 1rem;
                top: 50%;
                transform: translateY(-50%);
                color: #999;
                font-size: 1.2rem;
            }
    
            .filters {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem;
                margin-bottom: 1rem;
            }
    
            .filter-group {
                display: flex;
                flex-direction: column;
                gap: 0.5rem;
            }
    
            .filter-label {
                font-weight: 600;
                color: var(--deep-red);
                font-size: 0.9rem;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
    
            .filter-select {
                padding: 0.75rem;
                border: 2px solid #E5E5E5;
                border-radius: 10px;
                background: white;
                font-size: 1rem;
                cursor: pointer;
                transition: all 0.3s ease;
            }
    
            .filter-select:focus {
                outline: none;
                border-color: var(--saffron);
                box-shadow: 0 0 0 3px rgba(255, 153, 51, 0.1);
            }
    
            .filter-actions {
                display: flex;
                gap: 1rem;
                justify-content: center;
                margin-top: 1rem;
            }
    
            .action-btn {
                background: var(--gradient-secondary);
                color: #333;
                border: none;
                padding: 0.75rem 1.5rem;
                border-radius: 10px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
    
            .action-btn:hover {
                transform: translateY(-2px);
                box-shadow: var(--shadow-hover);
            }
    
            .action-btn.clear {
                background: linear-gradient(135deg, #dc3545, #c82333);
                color: white;
            }
    
            /* Alumni Grid */
            .alumni-grid {
                max-width: 1400px;
                margin: 0 auto;
                padding: 0 1.5rem;
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                gap: 1.5rem;
                margin-bottom: 3rem;
            }
    
            .alumni-card {
                background: var(--gradient-card);
                border-radius: 20px;
                overflow: hidden;
                box-shadow: var(--shadow-soft);
                transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                position: relative;
            }
    
            .alumni-card:hover {
                transform: translateY(-8px);
                box-shadow: var(--shadow-hover);
            }
    
            .card-header {
                position: relative;
                background: var(--gradient-primary);
                padding: 1.5rem;
                text-align: center;
            }
    
            .alumni-photo {
                width: 80px;
                height: 80px;
                border-radius: 50%;
                margin: 0 auto 1rem;
                border: 4px solid white;
                background: white;
                object-fit: cover;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                transition: all 0.3s ease;
            }
    
            .alumni-card:hover .alumni-photo {
                transform: scale(1.05);
            }
    
            .default-avatar {
                width: 80px;
                height: 80px;
                border-radius: 50%;
                margin: 0 auto 1rem;
                border: 4px solid white;
                background: linear-gradient(135deg, #FFD700, #FFA500);
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 2rem;
                color: white;
                font-weight: 700;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            }
    
            .alumni-name {
                color: white;
                font-size: 1.3rem;
                font-weight: 700;
                margin-bottom: 0.5rem;
                text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
            }
    
            .alumni-year {
                color: rgba(255,255,255,0.9);
                font-size: 0.9rem;
                background: rgba(255,255,255,0.2);
                padding: 0.3rem 0.8rem;
                border-radius: 15px;
                display: inline-block;
            }
    
            .card-body {
                padding: 1.5rem;
            }
    
            .info-item {
                display: flex;
                align-items: flex-start;
                gap: 0.75rem;
                margin-bottom: 1rem;
                padding: 0.75rem;
                background: rgba(255, 153, 51, 0.05);
                border-radius: 10px;
                transition: all 0.3s ease;
            }
    
            .info-item:hover {
                background: rgba(255, 153, 51, 0.1);
            }
    
            .info-icon {
                width: 20px;
                color: var(--saffron);
                font-size: 1.1rem;
                margin-top: 0.1rem;
                flex-shrink: 0;
            }
    
            .info-text {
                flex: 1;
                font-size: 0.95rem;
                line-height: 1.4;
            }
    
            .info-label {
                font-weight: 600;
                color: var(--deep-red);
                display: block;
                font-size: 0.8rem;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                margin-bottom: 0.2rem;
            }
    
            .contact-actions {
                display: flex;
                gap: 0.5rem;
                margin-top: 1rem;
            }
    
            .contact-btn {
                flex: 1;
                padding: 0.75rem;
                border: none;
                border-radius: 10px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
                text-decoration: none;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 0.5rem;
                font-size: 0.9rem;
            }
    
            .whatsapp-btn {
                background: linear-gradient(135deg, #25D366, #128C7E);
                color: white;
            }
    
            .whatsapp-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(37, 211, 102, 0.3);
            }
    
            .phone-btn {
                background: var(--gradient-secondary);
                color: #333;
            }
    
            .phone-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(255, 215, 0, 0.3);
            }
    
            /* No Results */
            .no-results {
                text-align: center;
                padding: 4rem 2rem;
                color: #666;
                grid-column: 1 / -1;
            }
    
            .no-results i {
                font-size: 4rem;
                color: var(--saffron);
                margin-bottom: 1rem;
            }
    
            .no-results h3 {
                font-size: 1.5rem;
                margin-bottom: 0.5rem;
                color: var(--deep-red);
            }
    
            /* Footer */
            .footer {
                background: var(--gradient-primary);
                color: white;
                text-align: center;
                padding: 2rem;
                margin-top: 3rem;
            }
    
            .footer-content {
                max-width: 1400px;
                margin: 0 auto;
            }
    
            .footer-links {
                margin-top: 1rem;
                display: flex;
                justify-content: center;
                gap: 2rem;
                flex-wrap: wrap;
            }
    
            .footer-link {
                color: rgba(255,255,255,0.8);
                text-decoration: none;
                transition: color 0.3s ease;
            }
    
            .footer-link:hover {
                color: var(--gold);
            }
    
            /* Responsive Design */
            @media (max-width: 768px) {
                .header-title {
                    font-size: 1.5rem;
                }
                
                .stats {
                    gap: 1rem;
                }
                
                .stat-item {
                    padding: 0.4rem 0.8rem;
                }
                
                .stat-number {
                    font-size: 1.2rem;
                }
                
                .alumni-grid {
                    grid-template-columns: 1fr;
                    gap: 1rem;
                }
                
                .filters {
                    grid-template-columns: 1fr;
                }
                
                .filter-actions {
                    flex-direction: column;
                }
                
                .contact-actions {
                    flex-direction: column;
                }
            }
    
            @media (max-width: 480px) {
                .header-content {
                    text-align: center;
                }
                
                .logo-section {
                    flex-direction: column;
                    gap: 0.5rem;
                }
                
                .search-section {
                    padding: 1.5rem;
                }
                
                .alumni-card {
                    margin: 0;
                }
            }
    
            /* Animations */
            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
    
            .alumni-card {
                animation: fadeInUp 0.5s ease forwards;
            }
    
            .alumni-card:nth-child(even) {
                animation-delay: 0.1s;
            }
    
            .alumni-card:nth-child(3n) {
                animation-delay: 0.2s;
            }
    
            /* Loading skeleton for images */
            .photo-skeleton {
                background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
                background-size: 200% 100%;
                animation: loading 1.5s infinite;
            }
    
            @keyframes loading {
                0% { background-position: 200% 0; }
                100% { background-position: -200% 0; }
            }
        </style>
    </head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo">SSKV</div>
                <div>
                    <h1 class="header-title">Alumni Directory</h1>
                    <p class="header-subtitle">Connecting generations of excellence</p>
                </div>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-number" id="totalAlumni">0</span>
                    <span class="stat-label">Alumni</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="filteredCount">0</span>
                    <span class="stat-label">Shown</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Controls -->
    <div class="controls">
        <div class="search-section">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="Search by name, profession, location...">
            </div>
            <div class="filters">
                <div class="filter-group">
                    <label class="filter-label">Last Year at SSKV</label>
                    <select class="filter-select" id="yearFilter">
                        <option value="">All Years</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Location</label>
                    <select class="filter-select" id="locationFilter">
                        <option value="">All Locations</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Profession</label>
                    <select class="filter-select" id="professionFilter">
                        <option value="">All Professions</option>
                    </select>
                </div>
            </div>
            <div class="filter-actions">
                <button class="action-btn clear" id="clearFilters">
                    <i class="fas fa-times"></i> Clear Filters
                </button>
                <button class="action-btn" id="randomize">
                    <i class="fas fa-random"></i> Show Random
                </button>
            </div>
        </div>
    </div>

    <!-- Alumni Grid -->
    <div class="alumni-grid" id="alumniGrid"></div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 SSKV Alumni Directory. Connecting generations of excellence.</p>
            <p style="margin-top: 0.5rem; opacity: 0.8;">
                <i class="fas fa-heart" style="color: #FFD700;"></i> Made with love for the SSKV family
            </p>
        </div>
    </footer>

    <!-- Load the SheetJS library first -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        const GITHUB_BASE_URL = "https://BharathSubbarao.github.io/sskv-alumni-directory/images/";
        let alumniData = [];
        let filteredAlumni = [];
        let searchTimeout;

        async function loadExcelData() {
            try {
                const response = await fetch("SSKV_Alumni_Data.xlsx");
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: "array" });
                const sheetName = workbook.SheetNames[0];
                const sheet = workbook.Sheets[sheetName];
                const jsonData = XLSX.utils.sheet_to_json(sheet);

                console.log("Parsed Excel rows:", jsonData.slice(0, 3));

                alumniData = jsonData.map(row => ({
                    name: row["Full Name"] || "",
                    lastYear: row["Last Year at SSKV"] || "",
                    location: row["Location"] || "",
                    profession: row["Profession"] || "",
                    contact: row["Contact Number"] || "",
                    whatsappName: row["WhatsApp Name"] || "",
                    photoUrl: GITHUB_BASE_URL + row["Photo File"]
                }));

                console.log("alumni data rows:", alumniData.slice(0, 3));

                filteredAlumni = [...alumniData];
                initializeApp();
            } catch (err) {
                console.error("Error loading Excel:", err);
            }
        }

        /* === all helper functions, render, filters, etc. remain exactly the same as in your original === */

        function getInitials(name) {
        return name
            .split(" ")
            .map((w) => w.charAt(0))
            .join("")
            .substring(0, 2)
            .toUpperCase();
        }
        function truncateText(text, maxLength) {
        if (!text) return "";
        return text.length > maxLength ? text.substring(0, maxLength) + "..." : text;
        }

        function formatPhoneForWhatsApp(phone) {
            if (!phone) return '';

            // Ensure it's a string
            phone = String(phone).trim();

            // Remove all non-digit characters except +
            let cleaned = phone.replace(/[^\d+]/g, '');

            // Handle different phone number formats
            if (cleaned.startsWith('+91')) {
                return cleaned;
            } else if (cleaned.startsWith('91') && cleaned.length > 10) {
                return '+' + cleaned;
            } else if (cleaned.length === 10 && !cleaned.startsWith('0')) {
                return '+91' + cleaned;
            } else if (cleaned.startsWith('+')) {
                return cleaned;
            } else if (cleaned.length > 10) {
                return '+' + cleaned;
            }

            return '+91' + cleaned;
        }


        function getProfessionCategory(p) {
        if (!p) return "Other";
        const l = p.toLowerCase();
        if (
            l.includes("software") ||
            l.includes("it ") ||
            l.includes("tech") ||
            l.includes("program")
        )
            return "Technology";
        if (
            l.includes("manager") ||
            l.includes("business") ||
            l.includes("consultant") ||
            l.includes("operations")
        )
            return "Management";
        if (
            l.includes("doctor") ||
            l.includes("medical") ||
            l.includes("optometrist")
        )
            return "Healthcare";
        if (
            l.includes("teacher") ||
            l.includes("education") ||
            l.includes("lecturer")
        )
            return "Education";
        if (
            l.includes("engineer") ||
            l.includes("scientist") ||
            l.includes("research")
        )
            return "Engineering & Science";

        if (
            l.includes("lawyer") || 
            l.includes("legal") || 
            l.includes("judicial")
        ) 
            return "Legal";

        if (
            l.includes("self") ||
            l.includes("freelance") ||
            l.includes("entrepreneur")
        )
            return "Entrepreneurship";
        if (
            l.includes("photographer") ||
            l.includes("designer") ||
            l.includes("creative")
        )
            return "Creative";
        if (
            l.includes("finance") ||
            l.includes("investment") ||
            l.includes("income-tax")
        )
            return "Finance";
        if (l.includes("pharmacist") || l.includes("pharma")) return "Pharmaceutical";
        return "Other";
        }

        function populateFilters() {
        const years = [...new Set(alumniData.map((a) => a.lastYear))].sort();
        const locs = [...new Set(alumniData.map((a) => a.location))].sort();
        const profs = [
            ...new Set(alumniData.map((a) => getProfessionCategory(a.profession))),
        ].sort();
        populateSelect("yearFilter", years);
        populateSelect("locationFilter", locs);
        populateSelect("professionFilter", profs);
        }
        function populateSelect(id, options) {
        const s = document.getElementById(id);
        while (s.children.length > 1) s.removeChild(s.lastChild);
        options.forEach((o) => {
            const e = document.createElement("option");
            e.value = o;
            e.textContent = o;
            s.appendChild(e);
        });
        }

        function renderAlumni(list) {
        const grid = document.getElementById("alumniGrid");
        if (list.length === 0) {
            grid.innerHTML = `<div class="no-results"><i class="fas fa-search"></i><h3>No Alumni Found</h3><p>Try adjusting your search criteria or clearing filters.</p></div>`;
            return;
        }
        grid.innerHTML = list
            .map((a, i) => {
            const initials = getInitials(a.name);
            const photo = a.photoUrl
                ? `<img src="${a.photoUrl}" alt="${a.name}" class="alumni-photo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" loading="lazy"><div class="default-avatar" style="display:none;">${initials}</div>`
                : `<div class="default-avatar">${initials}</div>`;
            return `<div class="alumni-card" style="animation-delay:${Math.min(i * 0.1, 2)}s"><div class="card-header">${photo}<h3 class="alumni-name">${a.name}</h3><span class="alumni-year">${a.lastYear}</span></div><div class="card-body"><div class="info-item"><i class="fas fa-map-marker-alt info-icon"></i><div class="info-text"><span class="info-label">Location</span>${a.location}</div></div><div class="info-item"><i class="fas fa-briefcase info-icon"></i><div class="info-text"><span class="info-label">Profession</span>${truncateText(a.profession, 120)}</div></div>${a.contact ? `<div class="contact-actions"><a href="https://wa.me/${formatPhoneForWhatsApp(a.contact)}?text=Hi ${encodeURIComponent(a.whatsappName || a.name)}, I found you through the SSKV Alumni Directory!" class="contact-btn whatsapp-btn" target="_blank" rel="noopener"><i class="fab fa-whatsapp"></i> WhatsApp</a><a href="tel:${a.contact}" class="contact-btn phone-btn"><i class="fas fa-phone"></i> Call</a></div>` : ""}</div></div>`;
            })
            .join("");
        }

        function filterAlumni() {
        const search = document
            .getElementById("searchInput")
            .value.toLowerCase()
            .trim();
        const y = document.getElementById("yearFilter").value;
        const l = document.getElementById("locationFilter").value;
        const p = document.getElementById("professionFilter").value;
        filteredAlumni = alumniData.filter((a) => {
            const mS =
            !search ||
            a.name.toLowerCase().includes(search) ||
            a.profession.toLowerCase().includes(search) ||
            a.location.toLowerCase().includes(search) ||
            a.lastYear.toLowerCase().includes(search);
            const mY = !y || a.lastYear === y;
            const mL = !l || a.location === l;
            const mP = !p || getProfessionCategory(a.profession) === p;
            return mS && mY && mL && mP;
        });
        renderAlumni(filteredAlumni);
        updateStats();
        }
        function updateStats() {
        document.getElementById("totalAlumni").textContent = alumniData.length;
        document.getElementById("filteredCount").textContent = filteredAlumni.length;
        }
        function clearFilters() {
        document.getElementById("searchInput").value = "";
        document.getElementById("yearFilter").value = "";
        document.getElementById("locationFilter").value = "";
        document.getElementById("professionFilter").value = "";
        filteredAlumni = [...alumniData];
        renderAlumni(filteredAlumni);
        updateStats();
        }
        function showRandomAlumni() {
        const s = [...alumniData].sort(() => 0.5 - Math.random());
        const r = s.slice(0, Math.min(6, s.length));
        renderAlumni(r);
        document.getElementById("filteredCount").textContent = r.length;
        }

        function setupEventListeners() {
        document.getElementById("searchInput").addEventListener("input", () => {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(filterAlumni, 300);
        });
        document
            .getElementById("yearFilter")
            .addEventListener("change", filterAlumni);
        document
            .getElementById("locationFilter")
            .addEventListener("change", filterAlumni);
        document
            .getElementById("professionFilter")
            .addEventListener("change", filterAlumni);
        document
            .getElementById("clearFilters")
            .addEventListener("click", clearFilters);
        document
            .getElementById("randomize")
            .addEventListener("click", showRandomAlumni);
        document.addEventListener("keydown", (e) => {
            if (e.key === "Escape") clearFilters();
            if ((e.ctrlKey || e.metaKey) && e.key === "f") {
            e.preventDefault();
            document.getElementById("searchInput").focus();
            }
        });
        }

        function initializeApp() {
        populateFilters();
        renderAlumni(filteredAlumni);
        updateStats();
        setupEventListeners();
        }

        document.addEventListener('DOMContentLoaded', loadExcelData);
    </script>
</body>
</html>
